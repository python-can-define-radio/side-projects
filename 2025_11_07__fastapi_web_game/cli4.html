<canvas id="canvas" width="400" height="400" style="border: 1px solid black"></canvas>
<script>
  const canvas = document.getElementById("canvas");
  const ctx = canvas.getContext("2d");
  const socket = new WebSocket("ws://localhost:8000/ws");
  socket.onmessage = function (event) {
    try {
      const recvd = JSON.parse(event.data);
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      for (const cid of Object.keys(recvd)) {
        const [x, y] = recvd[cid];
        ctx.fillStyle = "green";
        ctx.fillRect(x, y, 10, 10);
        ctx.font = '12px Arial';
        ctx.fillStyle = 'black';
        ctx.fillText(cid, x - 4, y + 20);
      }
    } catch (e) {
      alert(`onmessage error: ${e}`);
    }
  };

  canvas.addEventListener("click", function (event) {
    try {
      const rect = canvas.getBoundingClientRect();
      const x = event.clientX - rect.left;
      const y = event.clientY - rect.top;
      socket.send(JSON.stringify({ x, y }));
    } catch (e) {
      alert(`click error: ${e}`);
    }
  });
</script>